<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment</title>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.24/css/jquery.dataTables.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            white-space: nowrap;
            position: relative;
            left: -10px;
        }
    </style>
</head>
<body>
    <div id="results"></div>
    <button id="exportBtn">Export to Excel</button>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script> 
    <script>
        $(document).ready(function () {
            var data = JSON.parse(document.getElementById('data').textContent); //parse data JSON

            // Parse datetime strings into Date objects
            data.forEach(function (item) {
                item.so_datecreated = moment(item.so_datecreated, 'YYYY-MM-DD HH:mm:ss').format('MM/DD/YYYY');
                item.so_taxrate = (item.so_taxrate * 100).toFixed(2) + '%';
                item.so_totalprice = '$' + item.so_totalprice.toFixed(2);
                item.so_totaltax = '$' + item.so_totaltax.toFixed(2);
            });

            var table = $('<table>').addClass('display').attr('id', 'dataTable').appendTo('#results'); //added table element

            // DataTable 
            var dataTable = $('#dataTable').DataTable({
                data: data,
                columns: [
                    { title: 'Sales Order Number', data: 'so_num' },
                    { title: 'Date Created', data: 'so_datecreated', type: 'date' },
                    { title: 'Note', data: 'so_note' },
                    { title: 'Ship To Name', data: 'shipto_name' },
                    { title: 'Tax Rate', data: 'so_taxrate' },
                    { title: 'Total Price', data: 'so_totalprice' },
                    { title: 'Total Tax', data: 'so_totaltax' }
                ],
		lengthMenu: [[10, 25, 50, -1], [10, 25, 50, "All"]] // Show options: 10, 25, 50, and "All"
            });

            // Export to Excel
            $('#exportBtn').on('click', function() {
                dataTable.columns.adjust().draw(); // Adjust column widths before exporting
                var wb = XLSX.utils.book_new();
                var ws = XLSX.utils.json_to_sheet(dataTable.rows().data().toArray());

                // Column formats
                ws['!cols'] = [
                    {wch: 20}, // Sales Order Number
                    {wch: 15}, // Date Created
                    {wch: 30}, // Note
                    {wch: 20}, // Ship To Name
                    {wch: 15}, // Tax Rate
                    {wch: 15}, // Total Price
                    {wch: 15}  // Total Tax
                ];

                // Define column headers
                ws['A1'].v = 'Sales Order Number';
                ws['B1'].v = 'Date Created';
                ws['C1'].v = 'Note';
                ws['D1'].v = 'Ship To Name';
                ws['E1'].v = 'Tax Rate';
                ws['F1'].v = 'Total Price';
                ws['G1'].v = 'Total Tax';

                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                var wbout = XLSX.write(wb, {bookType:'xlsx', bookSST:true, type: 'binary'});
                saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}), 'export.xlsx');
            });

            function s2ab(s) {
                var buf = new ArrayBuffer(s.length);
                var view = new Uint8Array(buf);
                for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
                return buf;
            }
        });
    </script>
</body>
<script id="data" type="application/json">
	[
		{
			"so_num": "1000",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "Call front desk to confirm order",
			"shipto_name": "Allen's Groceries",
			"so_taxrate": 0,
			"so_totalprice": 15936.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1001",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "Only sending 16lbs flour and closing short, confirmed w/ Peggy in their A/P office",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 520.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1002",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Eric Washburn",
			"so_taxrate": 0,
			"so_totalprice": 2800.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1003",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Karen Smith",
			"so_taxrate": 0,
			"so_totalprice": 24.900000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1004",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Eric Washburn",
			"so_taxrate": 0,
			"so_totalprice": 1017.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1005",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 397.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1007",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Patricia Beverages",
			"so_taxrate": 0,
			"so_totalprice": 66.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1009",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim's Bake Shop",
			"so_taxrate": 0.0625,
			"so_totalprice": 5.310000000,
			"so_totaltax": 0.310000000
		},
		{
			"so_num": "1009-return",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "Created from RMA #1009-RMA",
			"shipto_name": "Jim's Bake Shop",
			"so_taxrate": 0.0625,
			"so_totalprice": -5.310000000,
			"so_totaltax": -0.310000000
		},
		{
			"so_num": "1011",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 3402.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1012",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Patricia Beverages",
			"so_taxrate": 0,
			"so_totalprice": 180.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1013",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 250.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1014",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Karen Smith",
			"so_taxrate": 0,
			"so_totalprice": 17.500000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1015",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim Raynor",
			"so_taxrate": 0.0625,
			"so_totalprice": 95.630000000,
			"so_totaltax": 5.630000000
		},
		{
			"so_num": "1016",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": 59.250000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1017",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Allen's Groceries",
			"so_taxrate": 0,
			"so_totalprice": 165.300000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1018",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim's Bake Shop 2",
			"so_taxrate": 0.0625,
			"so_totalprice": 1115.630000000,
			"so_totaltax": 65.630000000
		},
		{
			"so_num": "1019",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim's Bake Shop 2",
			"so_taxrate": 0.0625,
			"so_totalprice": 124.950000000,
			"so_totaltax": 7.350000000
		},
		{
			"so_num": "1020",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Patricia Beverages",
			"so_taxrate": 0,
			"so_totalprice": 32.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1021",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 397.500000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1022",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 128.350000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1023",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "Wedding event, be early",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 180.960000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1024",
			"so_datecreated": "2024-02-03 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Allen's Groceries",
			"so_taxrate": 0,
			"so_totalprice": 30.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1026",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 97.500000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1027",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Eric Washburn",
			"so_taxrate": 0,
			"so_totalprice": 28.250000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1028",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Patricia Beverages",
			"so_taxrate": 0,
			"so_totalprice": 83.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1029",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": 126.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1030",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 194.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1031",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 16.750000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1033",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": 101.890000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1034",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 17.890000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1035",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": 21.390000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1037",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 97.500000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1038",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Karen Smith",
			"so_taxrate": 0,
			"so_totalprice": 8.890000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1039",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 216.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1040",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Allen's Groceries",
			"so_taxrate": 0,
			"so_totalprice": 1510.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1041",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Eric Washburn",
			"so_taxrate": 0,
			"so_totalprice": 5.440000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1042",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Eric Washburn",
			"so_taxrate": 0,
			"so_totalprice": 5.440000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1043",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 28.900000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1044",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 28.900000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1045",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": 170.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1046",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim Raynor",
			"so_taxrate": 0.0625,
			"so_totalprice": 34.000000000,
			"so_totaltax": 2.000000000
		},
		{
			"so_num": "1048",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim's Bake Shop",
			"so_taxrate": 0.0625,
			"so_totalprice": 32.410000000,
			"so_totaltax": 1.910000000
		},
		{
			"so_num": "1049",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Candie Walker",
			"so_taxrate": 0,
			"so_totalprice": 77.890000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1050",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 65.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1051",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mountaineer Catering",
			"so_taxrate": 0,
			"so_totalprice": 60.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1052",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Karen Smith",
			"so_taxrate": 0,
			"so_totalprice": 6.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1053",
			"so_datecreated": "2024-02-08 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 67.900000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1054",
			"so_datecreated": "2024-03-09 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Jim's Bake Shop",
			"so_taxrate": 0.0625,
			"so_totalprice": 185.940000000,
			"so_totaltax": 10.940000000
		},
		{
			"so_num": "1055",
			"so_datecreated": "2024-03-09 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Baker Frontier",
			"so_taxrate": 0,
			"so_totalprice": -85.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1056",
			"so_datecreated": "2024-03-09 04:47:42.000000",
			"so_note": "",
			"shipto_name": "Mark Bennett",
			"so_taxrate": 0,
			"so_totalprice": 397.000000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "1057",
			"so_datecreated": "2024-03-25 03:06:16.781000",
			"so_note": "Created from RMA #2",
			"shipto_name": "Allen's Groceries",
			"so_taxrate": 0,
			"so_totalprice": -2.500000000,
			"so_totaltax": 0.000000000
		},
		{
			"so_num": "#1001",
			"so_datecreated": "2024-03-30 00:00:00.000000",
			"so_note": "",
			"shipto_name": "Karine Ruby",
			"so_taxrate": 0,
			"so_totalprice": 1383.910000000,
			"so_totaltax": 0.000000000
		}
	]    
</script>
</html>
